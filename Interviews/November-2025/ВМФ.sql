--1
--Почему ClickHouse предпочитают Postgres в аналитике? Объяснить архитектурно.

ClickHouse предпочитают в аналитике, потому что он архитектурно сделан для чтения,
агрегаций и сканов по большим данным, а PostgreSQL — для транзакций и консистентности,
а не для BI и DWH.

PostgreSQL
Данные хранятся построчно, При чтении одной ячейки читается вся строка целиком.
Запрос выполняется строка за строкой. Хорошо для OLTP.
Сжатие слабое . Разные типы данных в одной строке → плохо сжимаются.

ClickHouse
колоночное хранение, Каждый столбец хранится отдельно. Читаются только нужные колонки.
Запрос выполняется блоками по тысячи строк. Хорошо для OLAP.
Сжатие по столбцам. Одинаковые типы данных подряд → коэффициент сжатия в разы выше.


--2
--Чем отличается WHERE от HAVING?

WHERE
используется перед группировкой
не используется с агрегатами

HAVING
используется после группировки
используется с агрегатами


--3
BI я использую как витрину для продуктовых команд — стандартные дашборды и мониторинг.
А Python — для всего, что выходит за рамки типового отчёта: исследовательский анализ,
подготовка сложных выборок, статистика по A/B-тестам, простые модели и любые
нестандартные расчёты, которые в BI делать либо неудобно, либо невозможно


--4
--Как запланировать A/B тест?

1) Обозначить Гипотезы
H0: изменений нет по primary.
H1: есть улучшение (обычно односторонняя).

2)Задать Порог ошибок.

α = 0.05 (ошибка I рода), β = 0.2 (мощность 1−β = 80%) — частые дефолты.

3) расчитать MDE (минимальный детектируемый эффект).
Какой прирост имеет смысл бизнесу (например, +1.0 п.п. к конверсии или +3% к выручке/польз.). От него зависит выборка.

4) Расчитать Размер выборки
- Для долей:
- Для средних:

5) Прикинуть Срок теста.
6) Дизайн
единица рандомизации, стратификация (платформа/канал/новые vs возвращающиеся),
правило остановки. Короткий A/A для SRM и логов.


--5
--Какие метрики выбрать и почему

1) Primary
Зависит от цели бизнеса:

- продукт: конверсия в целевое действие на пользователя/сессию;
- монетизация: выручка/маржа на пользователя;
- скорость: p90/p95 времени (меньше = лучше);

2) Вторичные (механика эффекта).
CTR, время до действия, глубина, AOV, доля использования новой фичи и тд.

3) Гардрейлы (не должны просесть).
Ошибки/латентность, возвраты/жалобы, маржа/стоимость, стабильность трафика.


--6
--Как интерпретировать результаты

Оценка эффекта.

если Доли → разница пропорций (z-тест) + 95% ДИ.
Если Средние → t-тест; при хвостах — бутстрап.
Если Квантиль и другие сложные статистики → бутстрап ДИ.

Можно снизить дисперсию различными методами.

Что смотреть:
Если ДИ не включает 0 → полученный результат статистически значим на уровне α,
p-value,
величину эффекта,
гардрейлы и ключевые срезы

Что делать дальше:
Δprimary > 0, гардрейлы ок → rollout (постепенно).
Эффект слабый/неоднородный → пробовать еще раз или что-то менять
гардрейлы не ок, риски высоки → stop.



--8
--Зачем нужна разметка событий и как вы используете?

Чтобы понимать, что делает пользователь в продукте и связывать это с бизнес-метриками.

Разметка даёт возможность работы с:

- воронки, активация, ретеншен, конверсии.
- Диагностикой: где ломается путь, что тормозит (латентность/ошибки).
- A/B-тестами, эффект фич, опыт пользователей по сегментам.





--